# Artificial Non Intelligence - Data Analysis

A deep learning generated web game to raise awareness about AI and trolls.
This repository is about the Data Analysis and data.

For the API, check the [dedicated API repo](https://github.com/bolinocroustibat/artificial-non-intelligence-api).

For the frontend, check the [dedicated frontend repo](https://github.com/bolinocroustibat/artificial-non-intelligence-frontend).


## Main dependencies

- Python 3.8 or 3.9
- PostgreSQL database (currently Heroku Postgre)
- Streamlit

Create a virtual anvironemment for the project, and install the Python dependencies packages with:
```sh
pip install -r requirements.txt
```

...or, if you use Poetry (which is much better and strongly advised):
```sh
poetry install
```


## Data

JSON files from Kaggle and generated by external Notebooks are located in `/data` folder.


## To run locally

```sh
export DATABASE_URL=postgres://{user}:{password}@{hostname}:{port}/{database-name}
```

```sh
streamlit run app.py
```


## To deploy on Heroku

Add Heroku app as git origin, if necessary:
```sh
heroku git:remote -a non-intelligence-api
```

Deploy with:
```sh
git push heroku master
```


## Import data as JSON files into the database

Use the following script and edit it with the right filenames:
`python api/import_json.py`

Please note that it's recommended to first remove the existing comments from the database before importing. To do so, you can use this SQL command:
```sql
DELETE FROM comments;
```
(this should be added to the import script in the future)


## Comments crawlers

Located in /scraper.

Python script to get comments from online website comments and put them in a SQlite database. Uses a Peewee ORM and needs to be adapted to the current DB architecture.

Launch the crawler with Python from typer command file:
```sh
python3 ./scraper/crawl.py [website-crawler]
```

for example, for the crawler "Le Figaro":
```sh
python3 ./scraper/crawl.py figaro
```


## Database

### Schema

The database consists of two tables:

- `comments`: stores the human-generated and ai-generated comments, along with their unique ID, a flag `real` to indicate if it's human or ai generated and a few minor other infos. This table is used for the API to serve the game content.
```sql
CREATE TABLE comments (
	id SERIAL,
	content TEXT NOT NULL,
	real INTEGER NOT NULL,
	aggressive INTEGER,
	difficulty INTEGER,
	created timestamp DEFAULT CURRENT_TIMESTAMP
);
```

- `answers`: stores the answers from users from the game. Each answer has a foreign key to the `comments` table, and the IP adress of the user, along with few minor other infos:
```sql
CREATE TABLE answers (
	id SERIAL,
	answer INT NOT NULL,
	ip VARCHAR,
	comment INTEGER NOT NULL,
	FOREIGN KEY (comment) REFERENCES comments (id)
);
```


### Remove duplicate from the comments table of the DB

The import script doesn't check in the DB if there's any duplicates.
To remove the duplicated comments content from the DB at any time, use the following SQL command:
```sql
DELETE FROM comments
WHERE id NOT in(
		SELECT
			min(id)
			FROM comments
		GROUP BY
			content);
```
(this should be added to the import script in the future)
